(()=>{var e={668:e=>{e.exports=function(e){return atob(e)}},545:e=>{"use strict";var t={};e.exports=function(e){if("undefined"==typeof window)return null;var r=window.OfflineAudioContext||window.webkitOfflineAudioContext,n=window.AudioContext||window.webkitAudioContext;if(!n)return null;"number"==typeof e&&(e={sampleRate:e});var s=e&&e.sampleRate;if(e&&e.offline)return r?new r(e.channels||2,e.length,s||44100):null;var a=t[s];if(a)return a;try{a=new n(e)}catch(e){a=new n}return t[a.sampleRate]=t[s]=a,a}},433:(e,t,r)=>{"use strict";const n=r(545),s=r(284);e.exports=function e(t,r,a){r instanceof Function&&(a=r,r={}),r||(r={});let i=r.context||n();return t instanceof Blob&&(t=new File([t],"decode")),t instanceof File?new Promise(((n,s)=>{try{let s=new FileReader;s.readAsArrayBuffer(t),s.onload=()=>n(e(s.result,r,a))}catch(e){s(e)}})):(t instanceof ArrayBuffer||(t=s(t)),i.decodeAudioData(t.slice(),(e=>{a&&a(null,e)}),(e=>{a&&a(e)})))}},823:e=>{e.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},582:(e,t,r)=>{var n=r(823);e.exports=function(e,t,r){if(!e)throw new TypeError("must specify data as first parameter");if(r=0|+(r||0),Array.isArray(e)&&e[0]&&"number"==typeof e[0][0]){var s,a,i,o,l=e[0].length,u=e.length*l;t&&"string"!=typeof t||(t=new(n(t||"float32"))(u+r));var c=t.length-r;if(u!==c)throw new Error("source length "+u+" ("+l+"x"+e.length+") does not match destination length "+c);for(s=0,i=r;s<e.length;s++)for(a=0;a<l;a++)t[i++]=null===e[s][a]?NaN:e[s][a]}else if(t&&"string"!=typeof t)t.set(e,r);else{var f=n(t||"float32");if(Array.isArray(e)||"array"===t)for(s=0,i=r,o=(t=new f(e.length+r)).length;i<o;i++,s++)t[i]=null===e[s]?NaN:e[s];else 0===r?t=new f(e):(t=new f(e.length+r)).set(e,r)}return t}},648:function(e,t){!function(r){"use strict";function n(e,t){if(e instanceof Boolean||"boolean"==typeof e)return!1;if(t instanceof Object||(t={}),t.hasOwnProperty("allowBlank")&&!t.allowBlank&&""===e)return!1;var r="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+/]{3}=)?";return t.mime&&(r="(data:\\w+\\/[a-zA-Z\\+\\-\\.]+;base64,)?"+r),!1===t.paddingRequired&&(r="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}(==)?|[A-Za-z0-9+\\/]{3}=?)?"),new RegExp("^"+r+"$","gi").test(e)}e.exports&&(t=e.exports=n),t.isBase64=n}()},179:(e,t,r)=>{"use strict";r.r(t)},985:(e,t,r)=>{"use strict";r.r(t)},634:(e,t,r)=>{"use strict";var n=r(668),s=r(648);function a(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t.buffer}e.exports=function(e){if("string"!=typeof e)throw Error("Argument should be a string");return/^data\:/i.test(e)?function(e){var t=(e=e.replace(/\r?\n/g,"")).indexOf(",");if(-1===t||t<=4)throw new TypeError("malformed data-URI");for(var r=e.substring(5,t).split(";"),s=!1,i="US-ASCII",o=0;o<r.length;o++)"base64"==r[o]?s=!0:0==r[o].indexOf("charset=")&&(i=r[o].substring(8));var l=unescape(e.substring(t+1));s&&(l=n(l));var u=a(l);return u.type=r[0]||"text/plain",u.charset=i,u}(e):(s(e)&&(e=n(e)),a(e))}},284:(e,t,r)=>{"use strict";var n=r(634),s=r(582);e.exports=function e(t){if(!t)return new ArrayBuffer;if(t instanceof ArrayBuffer)return t;if("string"==typeof t)return n(t);if(ArrayBuffer.isView(t))return null!=t.byteOffset?t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength):t.buffer;if(t.buffer||t.data||t._data)return e(t.buffer||t.data||t._data);if(null!=t.length)for(var r=0;r<t.length;r++)if(null!=t[r].length){t=s(t);break}return new Uint8Array(null!=t.length?t:[t]).buffer}},146:(e,t,r)=>{const n=r(544);e.exports=class extends n{constructor(e){super(),this._messageId=1,this._messages=new Map,this._worker=e,this._worker.onmessage=this._onMessage.bind(this),this._id=Math.ceil(1e7*Math.random())}terminate(){this._worker.terminate()}isFree(){return 0===this._messages.size}jobsLength(){return this._messages.size}exec(e,t=null,r=[],n){return new Promise(((s,a)=>{const i=this._messageId++;this._messages.set(i,[s,a,n]),this._worker.postMessage([i,t,e],r||[])}))}postMessage(e=null,t=[],r){return new Promise(((n,s)=>{const a=this._messageId++;this._messages.set(a,[n,s,r]),this._worker.postMessage([a,e],t||[])}))}emit(e,...t){this._worker.postMessage({eventName:e,args:t})}_onMessage(e){if(!Array.isArray(e.data)&&e.data.eventName)return super.emit(e.data.eventName,...e.data.args);const[t,...r]=e.data;if(1===t)this._onEvent(...r);else{if(0!==t)throw new Error(`Wrong message type '${t}'`);this._onResult(...r)}}_onResult(e,t,r){const[n,s]=this._messages.get(e);return this._messages.delete(e),1===t?n(r):s(r)}_onEvent(e,t,r){const[,,n]=this._messages.get(e);n&&n(t,r)}}},544:e=>{e.exports=class{constructor(){Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}emit(e,...t){if(!this.__listeners[e])return this;for(const r of this.__listeners[e])r(...t);return this}once(e,t){const r=(...n)=>{this.off(e,r),t(...n)};return this.on(e,r)}on(e,t){return this.__listeners[e]||(this.__listeners[e]=[]),this.__listeners[e].push(t),this}off(e,t){return this.__listeners[e]=t?this.__listeners[e].filter((e=>e!==t)):[],this}}}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.m=e,r.u=e=>e+".js",r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),r.b=document.baseURI||self.location.href,(()=>{const e=r(146),t=r(433);var n;function s(e){n.innerHTML=e}r(179),r(985),window.addEventListener("load",(async function(){n=document.getElementById("status-bar");const l=document.getElementById("text-input"),u=document.getElementById("aligned-text"),c=document.getElementById("file-input"),f=document.getElementById("file-play");c.addEventListener("change",(async()=>{const e=c.files[0];f.src=URL.createObjectURL(e);let r=await t(e);a={sampleRate:r.sampleRate,channelData:[r.getChannelData(0)]}}));let g=null;l.addEventListener("input",(()=>{clearTimeout(g),g=setTimeout((async function e(){if(null!==i&&o)if(null===a)s("Please select a WAV file to align"),setTimeout(e,500);else{s("Aligning: "+l.value);try{hypseg=await i.exec("align",{audio:a,text:l.value}),console.log(hypseg),u.innerHTML="";for(const e in hypseg){const t=document.createElement("span");t.textContent=hypseg[e].word,t.className="segment pure-button",t.title="("+hypseg[e].start+":"+hypseg[e].end+")",t.addEventListener("click",(async()=>{const t=hypseg[e].end-hypseg[e].start;f.currentTime=hypseg[e].start,await f.play(),setTimeout((()=>{f.pause()}),1e3*t)})),u.appendChild(t),e!=hypseg.length-1&&u.append(document.createTextNode(" "))}}catch(e){s("Error aligning: "+e.message)}}else s("Waiting for speech recognition..."),setTimeout(e,500)}),500)}));try{i=new e(new Worker(new URL(r.p+r.u(364),r.b))),await i.exec("initialize",{loglevel:"DEBUG"}),s("Speech recognition ready"),o=!0}catch(e){s("Error initializing speech aligner: "+e.message)}}));var a=null,i=null,o=!1})()})();